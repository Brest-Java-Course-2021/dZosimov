DROP TABLE IF EXISTS lib_reader;
DROP TABLE IF EXISTS lib_book;

CREATE TABLE lib_reader {
    reader_id integer NOT NULL GENERATED BY DEFAULT AS IDENTITY(INCREMENT 1 START 1 MINVALUE 1 MAXVALUE 2000000 CACHE 1),
    first_name varchar(20) NOT NULL,
    last_name varchar(30) NOT NULL,
    patronymic varchar(25),
    date_of_registry date NOT NULL,
    active boolean DEFAULT TRUE,
    PRIMARY KEY (reader_id),
};

CREATE TABLE lib_book {
    book_id integer NOT NULL GENERATED BY DEFAULT AS IDENTITY(INCREMENT 1 START 1 MINVALUE 1 MAXVALUE 2000000 CACHE 1),
    authors varchar(60) NOT NULL,
    title varchar(60) NOT NULL,
    genre integer NOT NULL,
    reader_id integer,
    PRIMARY KEY (book_id),
    FOREIGN KEY (reader_id) REFERENCES lib_reader(reader_id) ON UPDATE RESTRICT,
};

INSERT INTO lib_book (authors, title, genre)
VALUES ('Тромгар Железноголовый', 'Алдуин есть', 2), ('Венегрус Монона', 'Амулет королей', 1),
('Ффулке', 'Астрология', 3), ('Пелларн Асси', 'Братья тьмы', 13), ('Биография Барензи', 'Стерн Гамбодж', 10);

INSERT INTO lib_reader(first_name, last_name, patronymic, date_of_registry)
VALUES('Септимий', 'Сегоний', 'Александрович', '2020-02-01'), ('Эйла', 'Охотница', 'Ивановна', '2020-01-01'),
('Йордис', 'Баббета', 'Александровна', '2020-02-04'), ('Цицерон', 'Партурнакс', 'Павлович', '2020-01-15');